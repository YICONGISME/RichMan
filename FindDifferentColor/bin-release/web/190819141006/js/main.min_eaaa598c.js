var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))(function(s,n){function o(t){try{h(r.next(t))}catch(e){n(e)}}function a(t){try{h(r["throw"](t))}catch(e){n(e)}}function h(t){t.done?s(t.value):new i(function(e){e(t.value)}).then(o,a)}h((r=r.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return r([t,e])}}function r(i){if(s)throw new TypeError("Generator is already executing.");for(;h;)try{if(s=1,n&&(o=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,n=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(o=h.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){h.label=i[1];break}if(6===i[0]&&h.label<o[1]){h.label=o[1],o=i;break}if(o&&h.label<o[2]){h.label=o[2],h.ops.push(i);break}o[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(r){i=[6,r],n=0}finally{s=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var s,n,o,a,h={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},Colors;!function(t){t.BLACK=0,t.DIMGRAY=6908265,t.GRAY=8421504,t.DARKGRAY=11119017,t.SILVER=12632256,t.LIGHTGREY=13882323,t.GAINSBORO=14474460,t.WHITESMOKE=16119285,t.WHITE=16777215,t.SNOW=16775930,t.GHOSTWHITE=16316671,t.FLORALWHITE=16775920,t.LINEN=16445670,t.ANTIQUEWHITE=16444375,t.PAPAYAWHIP=16773077,t.BLANCHEDALMOND=16772045,t.BISQUE=16770244,t.MOCCASIN=16770229,t.NAVAJOWHITE=16768685,t.PEACHPUFF=16767673,t.MISTYROSE=16770273,t.LAVENDERBLUSH=16773365,t.SEASHELL=16774638,t.OLDLACE=16643558,t.IVORY=16777200,t.HONEYDEW=15794160,t.MINTCREAM=16121850,t.AZURE=15794175,t.ALICEBLUE=15792383,t.LAVENDER=15132410,t.LIGHTSTEELBLUE=11584734,t.LIGHTSLATEGRAY=7833753,t.SLATEGRAY=7372944,t.STEELBLUE=4620980,t.ROYALBLUE=4286945,t.MIDNIGHTBLUE=1644912,t.NAVY=128,t.DARKBLUE=139,t.MEDIUMBLUE=205,t.BLUE=255,t.DODGERBLUE=2003199,t.CORNFLOWERBLUE=6591981,t.DEEPSKYBLUE=49151,t.LIGHTSKYBLUE=8900346,t.SKYBLUE=8900331,t.LIGHTBLUE=11393254,t.POWDERBLUE=11591910,t.PALETURQUOISE=11529966,t.LIGHTCYAN=14745599,t.CYAN=65535,t.AQUA=65535,t.TURQUOISE=4251856,t.MEDIUMTURQUOISE=4772300,t.DARKTURQUOISE=52945,t.LIGHTSEAGREEN=2142890,t.CADETBLUE=6266528,t.DARKCYAN=35723,t.TEAL=32896,t.DARKSLATEGRAY=3100495,t.DARKGREEN=25600,t.GREEN=32768,t.FORESTGREEN=2263842,t.SEAGREEN=3050327,t.MEDIUMSEAGREEN=3978097,t.MEDIUMAQUAMARINE=6737322,t.DARKSEAGREEN=9419919,t.AQUAMARINE=8388564,t.PALEGREEN=10025880,t.LIGHTGREEN=9498256,t.SPRINGGREEN=65407,t.MEDIUMSPRINGGREEN=64154,t.LAWNGREEN=8190976,t.CHARTREUSE=8388352,t.GREENYELLOW=11403055,t.LIME=65280,t.LIMEGREEN=3329330,t.YELLOWGREEN=10145074,t.DARKOLIVEGREEN=5597999,t.OLIVEDRAB=7048739,t.OLIVE=8421376,t.DARKKHAKI=12433259,t.PALEGOLDENROD=15657130,t.CORNSILK=16775388,t.BEIGE=16119260,t.LIGHTYELLOW=16777184,t.LIGHTGOLDENRODYELLOW=16448210,t.LEMONCHIFFON=16775885,t.WHEAT=16113331,t.BURLYWOOD=14596231,t.TAN=13808780,t.KHAKI=15787660,t.YELLOW=16776960,t.GOLD=16766720,t.ORANGE=16753920,t.SANDYBROWN=16032864,t.DARKORANGE=16747520,t.GOLDENROD=14329120,t.PERU=13468991,t.DARKGOLDENROD=12092939,t.CHOCOLATE=13789470,t.SIENNA=10506797,t.SADDLEBROWN=9127187,t.MAROON=8388608,t.DARKRED=9109504,t.BROWN=10824234,t.FIREBRICK=11674146,t.INDIANRED=13458524,t.ROSYBROWN=12357519,t.DARKSALMON=15308410,t.LIGHTCORAL=15761536,t.SALMON=16416882,t.LIGHTSALMON=16752762,t.CORAL=16744272,t.TOMATO=16737095,t.ORANGERED=16729344,t.RED=16711680,t.CRIMSON=14423100,t.MEDIUMVIOLETRED=13047173,t.DEEPPINK=16716947,t.HOTPINK=16738740,t.PALEVIOLETRED=14381203,t.PINK=16761035,t.LIGHTPINK=16758465,t.THISTLE=14204888,t.MAGENTA=16711935,t.FUCHSIA=16711935,t.VIOLET=15631086,t.PLUM=14524637,t.ORCHID=14315734,t.MEDIUMORCHID=12211667,t.DARKORCHID=10040012,t.DARKVIOLET=9699539,t.DARKMAGENTA=9109643,t.PURPLE=8388736,t.INDIGO=4915330,t.DARKSLATEBLUE=4734347,t.BLUEVIOLET=9055202,t.MEDIUMPURPLE=9662683,t.SLATEBLUE=6970061,t.MEDIUMSLATEBLUE=8087790,t.colors=[t.BLACK,t.DIMGRAY,t.GRAY,t.DARKGRAY,t.SILVER,t.LIGHTGREY,t.GAINSBORO,t.WHITESMOKE,t.WHITE,t.SNOW,t.GHOSTWHITE,t.FLORALWHITE,t.LINEN,t.ANTIQUEWHITE,t.PAPAYAWHIP,t.BLANCHEDALMOND,t.BISQUE,t.MOCCASIN,t.NAVAJOWHITE,t.PEACHPUFF,t.MISTYROSE,t.LAVENDERBLUSH,t.SEASHELL,t.OLDLACE,t.IVORY,t.HONEYDEW,t.MINTCREAM,t.AZURE,t.ALICEBLUE,t.LAVENDER,t.LIGHTSTEELBLUE,t.LIGHTSLATEGRAY,t.SLATEGRAY,t.STEELBLUE,t.ROYALBLUE,t.MIDNIGHTBLUE,t.NAVY,t.DARKBLUE,t.MEDIUMBLUE,t.BLUE,t.DODGERBLUE,t.CORNFLOWERBLUE,t.DEEPSKYBLUE,t.LIGHTSKYBLUE,t.SKYBLUE,t.LIGHTBLUE,t.POWDERBLUE,t.PALETURQUOISE,t.LIGHTCYAN,t.CYAN,t.AQUA,t.TURQUOISE,t.MEDIUMTURQUOISE,t.DARKTURQUOISE,t.LIGHTSEAGREEN,t.CADETBLUE,t.DARKCYAN,t.TEAL,t.DARKSLATEGRAY,t.DARKGREEN,t.GREEN,t.FORESTGREEN,t.SEAGREEN,t.MEDIUMSEAGREEN,t.MEDIUMAQUAMARINE,t.DARKSEAGREEN,t.AQUAMARINE,t.PALEGREEN,t.LIGHTGREEN,t.SPRINGGREEN,t.MEDIUMSPRINGGREEN,t.LAWNGREEN,t.CHARTREUSE,t.GREENYELLOW,t.LIME,t.LIMEGREEN,t.YELLOWGREEN,t.DARKOLIVEGREEN,t.OLIVEDRAB,t.OLIVE,t.DARKKHAKI,t.PALEGOLDENROD,t.CORNSILK,t.BEIGE,t.LIGHTYELLOW,t.LIGHTGOLDENRODYELLOW,t.LEMONCHIFFON,t.WHEAT,t.BURLYWOOD,t.TAN,t.KHAKI,t.YELLOW,t.GOLD,t.ORANGE,t.SANDYBROWN,t.DARKORANGE,t.GOLDENROD,t.PERU,t.DARKGOLDENROD,t.CHOCOLATE,t.SIENNA,t.SADDLEBROWN,t.MAROON,t.DARKRED,t.BROWN,t.FIREBRICK,t.INDIANRED,t.ROSYBROWN,t.DARKSALMON,t.LIGHTCORAL,t.SALMON,t.LIGHTSALMON,t.CORAL,t.TOMATO,t.ORANGERED,t.RED,t.CRIMSON,t.MEDIUMVIOLETRED,t.DEEPPINK,t.HOTPINK,t.PALEVIOLETRED,t.PINK,t.LIGHTPINK,t.THISTLE,t.MAGENTA,t.FUCHSIA,t.VIOLET,t.PLUM,t.ORCHID,t.MEDIUMORCHID,t.DARKORCHID,t.DARKVIOLET,t.DARKMAGENTA,t.PURPLE,t.INDIGO,t.DARKSLATEBLUE,t.BLUEVIOLET,t.MEDIUMPURPLE,t.SLATEBLUE,t.MEDIUMSLATEBLUE]}(Colors||(Colors={}));var GameManager;!function(t){t.level=1}(GameManager||(GameManager={}));var Grid=function(t){function e(e,i,r){void 0===r&&(r=16777215);var s=t.call(this)||this;return s._isDifferent=!1,s._row=e,s._col=i,s._color=r,s.initView(),s}return __extends(e,t),e.prototype.initView=function(){this.view=new egret.Shape,this.addChild(this.view),this.updateView()},e.prototype.updateView=function(){this.view.graphics.clear(),this.view.graphics.beginFill(this._color),this.view.graphics.drawRect(120*this.col,120*this.row,100,100),this.view.graphics.endFill()},Object.defineProperty(e.prototype,"row",{get:function(){return this._row},set:function(t){this._row=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"col",{get:function(){return this._col},set:function(t){this._col=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t,this.updateView()},enumerable:!0,configurable:!0}),e}(egret.Sprite);__reflect(Grid.prototype,"Grid");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(t){function e(){var e=t.call(this)||this;return e.level=1,e.grids=[],e.squareWidth=0,e.timeOnStart=0,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadResource()];case 1:return t.sent(),this.createGameScene(),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,RES.loadGroup("preload",0,t)];case 2:return i.sent(),this.stage.removeChild(t),[3,4];case 3:return e=i.sent(),console.error(e),[3,4];case 4:return[2]}})})},e.prototype.createGameScene=function(){this.game_bg=new egret.Bitmap;var t=RES.getRes("game_bg_png");this.game_bg.texture=t,this.addChild(this.game_bg),this.container=new egret.Sprite,this.container.x=5,this.container.y=egret.MainContext.instance.stage.stageHeight/2-egret.MainContext.instance.stage.stageWidth/2-5,this.addChild(this.container),this.is_level=new egret.TextField,this.countDown=new egret.TextField,this.countDown.x=egret.MainContext.instance.stage.stageWidth-150,this.countDown.y=150,this.countDown.textAlign="center",this.countDown.fontFamily="微软雅黑",this.countDown.size=30,this.countDown.textColor=15608876,this.countDown.strokeColor=15636992,this.addChild(this.countDown),this.bg=new egret.Bitmap;var e=RES.getRes("backgroud_png");this.bg.texture=e,this.bg.height=1136,this.addChild(this.bg),this.start_game=new egret.TextField,this.start_game.x=100,this.start_game.y=700,this.start_game.width=480,this.start_game.height=100,this.start_game.textAlign="center",this.start_game.fontFamily="微软雅黑",this.start_game.size=70,this.start_game.textColor=15641870,this.start_game.strokeColor=15636992,this.start_game.bold=!0,this.start_game.text="开始游戏",this.addChild(this.start_game),this.start_game.touchEnabled=!0,this.start_game.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startGame,this),this.start_game.addEventListener(egret.Event.ENTER_FRAME,this.onTimePass,this)},e.prototype.startGame=function(){this.status=2,this.contains(this.bg)&&this.removeChild(this.bg),this.contains(this.start_game)&&this.removeChild(this.start_game),this.time=new egret.Timer(5e3,1),this.container.removeChildren(),this.grids=[],this.level=1,this.is_level.x=100,this.is_level.y=100,this.is_level.width=480,this.is_level.height=100,this.is_level.textAlign="center",this.is_level.fontFamily="微软雅黑",this.is_level.size=70,this.is_level.textColor=6266528,this.is_level.strokeColor=15636992,this.is_level.bold=!0,this.is_level.text="第"+this.level+"关",this.addChild(this.is_level),this.squareWidth=egret.MainContext.instance.stage.stageWidth-10,console.log(egret.MainContext.instance.stage.stageHeight);var t=Math.floor(Math.log(100-this.level));1>t&&(t=1);for(var e=Math.floor(Math.random()*Colors.colors.length-t),i=Colors.colors[e],r=Colors.colors[e+t],s=Math.floor(Math.random()*(this.level+1)),n=Math.floor(Math.random()*(this.level+1)),o=0;o<this.level+1;o++){this.grids.push([]);for(var a=0;a<this.level+1;a++){if(a==s&&o==n){var h=new Grid(a,o,r);h._isDifferent=!0,this.grids[o].push(h)}else{var h=new Grid(a,o,i);this.grids[o].push(h)}h.touchEnabled=!0,this.container.addChild(h),this.time.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.gameOver,this),this.time.start(),h.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGridTouched,this),this.timeOnStart=egret.getTimer()}}console.log(this.grids),this.setContainerSize(),this.container.touchEnabled=!0,this.container.touchChildren=!0},e.prototype.onTimePass=function(t){if(2==this.status){var e=egret.getTimer(),i=this.timeOnStart,r=e-i,s=5-Math.floor(r/1e3);0>s&&(s=0),this.countDown.text="倒计时"+s+"秒"}},e.prototype.onGridTouched=function(t){console.log(t.target);var e=t.target;e._isDifferent===!0?(this.time.reset(),console.log("next level"),this.level++,this.update()):(this.time.stop(),console.log("game over"),this.gameOver())},e.prototype.gameOver=function(){this.status=3,this.failed_container=new egret.Sprite,this.addChild(this.failed_container),this.failed_container.x=5,this.game_over=new egret.Bitmap;var t=RES.getRes("game_bg_png");this.game_over.texture=t,this.game_over.alpha=.8,this.failed_container.addChild(this.game_over),this.game_failed=new egret.TextField,this.game_failed.x=100,this.game_failed.y=300,this.game_failed.width=480,this.game_failed.height=100,this.game_failed.textAlign="center",this.game_failed.fontFamily="微软雅黑",this.game_failed.size=90,this.game_failed.textColor=15608876,this.game_failed.strokeColor=15636992,this.game_failed.bold=!0,this.game_failed.text="闯关失败",this.failed_container.addChild(this.game_failed),this.retry=new egret.TextField,this.retry.x=50,this.retry.y=700,this.retry.width=480,this.retry.height=100,this.retry.textAlign="left",this.retry.fontFamily="微软雅黑",this.retry.size=50,this.retry.textColor=15636992,this.retry.strokeColor=15636992,this.retry.bold=!0,this.retry.text="重试",this.retry.touchEnabled=!0,this.failed_container.addChild(this.retry),this.retry.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRetryTouched,this),this.else_level=new egret.TextField,this.else_level.x=100,this.else_level.y=700,this.else_level.width=480,this.else_level.height=100,this.else_level.textAlign="right",this.else_level.fontFamily="微软雅黑",this.else_level.size=50,this.else_level.textColor=15636992,this.else_level.strokeColor=15636992,this.else_level.bold=!0,this.else_level.text="其他关卡",this.failed_container.addChild(this.else_level),this.container.touchEnabled=!1,this.container.touchChildren=!1},e.prototype.onRetryTouched=function(t){t.target;console.log("retry"),this.failed_container.parent.contains(this.failed_container)&&this.failed_container.parent.removeChild(this.failed_container),this.startGame()},e.prototype.update=function(){this.time.start(),this.timeOnStart=egret.getTimer(),this.is_level.text="第"+this.level+"关";var t=Math.floor(Math.log(10-this.level)/Math.log(2));1>t&&(t=1),console.log(t);for(var e=Math.floor(Math.random()*Colors.colors.length-t),i=Colors.colors[e],r=Colors.colors[e+t],s=Math.floor(Math.random()*(this.level+1)),n=Math.floor(Math.random()*(this.level+1)),o=this.level+1>8?8:this.level+1,a=0;o>a;a++){a>=this.grids.length&&this.grids.push([]);for(var h=0;o>h;h++){if(h>=this.grids[a].length){var E=new Grid(h,a);E.touchEnabled=!0,this.container.addChild(E),E.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGridTouched,this),this.grids[a].push(E)}h==s&&a==n?(this.grids[a][h].color=i,this.grids[a][h]._isDifferent=!0):(this.grids[a][h].color=r,this.grids[a][h]._isDifferent=!1)}}this.setContainerSize()},e.prototype.setContainerSize=function(){this.container.scaleX=this.squareWidth/this.container.width,this.container.scaleY=this.squareWidth/this.container.height},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);