var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);n.prototype=t.prototype,e.prototype=new n},__awaiter=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(s,o){function r(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?s(e.value):new n(function(t){t(e.value)}).then(r,a)}c((i=i.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return i([e,t])}}function i(n){if(s)throw new TypeError("Generator is already executing.");for(;c;)try{if(s=1,o&&(r=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(r=r.call(o,n[1])).done)return r;switch(o=0,r&&(n=[0,r.value]),n[0]){case 0:case 1:r=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(r=c.trys,!(r=r.length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){c.label=n[1];break}if(6===n[0]&&c.label<r[1]){c.label=r[1],r=n;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(n);break}r[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(i){n=[6,i],o=0}finally{s=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var s,o,r,a,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},Colors;!function(e){e.BLACK=0,e.DIMGRAY=6908265,e.GRAY=8421504,e.DARKGRAY=11119017,e.SILVER=12632256,e.LIGHTGREY=13882323,e.GAINSBORO=14474460,e.WHITESMOKE=16119285,e.WHITE=16777215,e.SNOW=16775930,e.GHOSTWHITE=16316671,e.FLORALWHITE=16775920,e.LINEN=16445670,e.ANTIQUEWHITE=16444375,e.PAPAYAWHIP=16773077,e.BLANCHEDALMOND=16772045,e.BISQUE=16770244,e.MOCCASIN=16770229,e.NAVAJOWHITE=16768685,e.PEACHPUFF=16767673,e.MISTYROSE=16770273,e.LAVENDERBLUSH=16773365,e.SEASHELL=16774638,e.OLDLACE=16643558,e.IVORY=16777200,e.HONEYDEW=15794160,e.MINTCREAM=16121850,e.AZURE=15794175,e.ALICEBLUE=15792383,e.LAVENDER=15132410,e.LIGHTSTEELBLUE=11584734,e.LIGHTSLATEGRAY=7833753,e.SLATEGRAY=7372944,e.STEELBLUE=4620980,e.ROYALBLUE=4286945,e.MIDNIGHTBLUE=1644912,e.NAVY=128,e.DARKBLUE=139,e.MEDIUMBLUE=205,e.BLUE=255,e.DODGERBLUE=2003199,e.CORNFLOWERBLUE=6591981,e.DEEPSKYBLUE=49151,e.LIGHTSKYBLUE=8900346,e.SKYBLUE=8900331,e.LIGHTBLUE=11393254,e.POWDERBLUE=11591910,e.PALETURQUOISE=11529966,e.LIGHTCYAN=14745599,e.CYAN=65535,e.AQUA=65535,e.TURQUOISE=4251856,e.MEDIUMTURQUOISE=4772300,e.DARKTURQUOISE=52945,e.LIGHTSEAGREEN=2142890,e.CADETBLUE=6266528,e.DARKCYAN=35723,e.TEAL=32896,e.DARKSLATEGRAY=3100495,e.DARKGREEN=25600,e.GREEN=32768,e.FORESTGREEN=2263842,e.SEAGREEN=3050327,e.MEDIUMSEAGREEN=3978097,e.MEDIUMAQUAMARINE=6737322,e.DARKSEAGREEN=9419919,e.AQUAMARINE=8388564,e.PALEGREEN=10025880,e.LIGHTGREEN=9498256,e.SPRINGGREEN=65407,e.MEDIUMSPRINGGREEN=64154,e.LAWNGREEN=8190976,e.CHARTREUSE=8388352,e.GREENYELLOW=11403055,e.LIME=65280,e.LIMEGREEN=3329330,e.YELLOWGREEN=10145074,e.DARKOLIVEGREEN=5597999,e.OLIVEDRAB=7048739,e.OLIVE=8421376,e.DARKKHAKI=12433259,e.PALEGOLDENROD=15657130,e.CORNSILK=16775388,e.BEIGE=16119260,e.LIGHTYELLOW=16777184,e.LIGHTGOLDENRODYELLOW=16448210,e.LEMONCHIFFON=16775885,e.WHEAT=16113331,e.BURLYWOOD=14596231,e.TAN=13808780,e.KHAKI=15787660,e.YELLOW=16776960,e.GOLD=16766720,e.ORANGE=16753920,e.SANDYBROWN=16032864,e.DARKORANGE=16747520,e.GOLDENROD=14329120,e.PERU=13468991,e.DARKGOLDENROD=12092939,e.CHOCOLATE=13789470,e.SIENNA=10506797,e.SADDLEBROWN=9127187,e.MAROON=8388608,e.DARKRED=9109504,e.BROWN=10824234,e.FIREBRICK=11674146,e.INDIANRED=13458524,e.ROSYBROWN=12357519,e.DARKSALMON=15308410,e.LIGHTCORAL=15761536,e.SALMON=16416882,e.LIGHTSALMON=16752762,e.CORAL=16744272,e.TOMATO=16737095,e.ORANGERED=16729344,e.RED=16711680,e.CRIMSON=14423100,e.MEDIUMVIOLETRED=13047173,e.DEEPPINK=16716947,e.HOTPINK=16738740,e.PALEVIOLETRED=14381203,e.PINK=16761035,e.LIGHTPINK=16758465,e.THISTLE=14204888,e.MAGENTA=16711935,e.FUCHSIA=16711935,e.VIOLET=15631086,e.PLUM=14524637,e.ORCHID=14315734,e.MEDIUMORCHID=12211667,e.DARKORCHID=10040012,e.DARKVIOLET=9699539,e.DARKMAGENTA=9109643,e.PURPLE=8388736,e.INDIGO=4915330,e.DARKSLATEBLUE=4734347,e.BLUEVIOLET=9055202,e.MEDIUMPURPLE=9662683,e.SLATEBLUE=6970061,e.MEDIUMSLATEBLUE=8087790,e.colors=[e.BLACK,e.DIMGRAY,e.GRAY,e.DARKGRAY,e.SILVER,e.LIGHTGREY,e.GAINSBORO,e.WHITESMOKE,e.WHITE,e.SNOW,e.GHOSTWHITE,e.FLORALWHITE,e.LINEN,e.ANTIQUEWHITE,e.PAPAYAWHIP,e.BLANCHEDALMOND,e.BISQUE,e.MOCCASIN,e.NAVAJOWHITE,e.PEACHPUFF,e.MISTYROSE,e.LAVENDERBLUSH,e.SEASHELL,e.OLDLACE,e.IVORY,e.HONEYDEW,e.MINTCREAM,e.AZURE,e.ALICEBLUE,e.LAVENDER,e.LIGHTSTEELBLUE,e.LIGHTSLATEGRAY,e.SLATEGRAY,e.STEELBLUE,e.ROYALBLUE,e.MIDNIGHTBLUE,e.NAVY,e.DARKBLUE,e.MEDIUMBLUE,e.BLUE,e.DODGERBLUE,e.CORNFLOWERBLUE,e.DEEPSKYBLUE,e.LIGHTSKYBLUE,e.SKYBLUE,e.LIGHTBLUE,e.POWDERBLUE,e.PALETURQUOISE,e.LIGHTCYAN,e.CYAN,e.AQUA,e.TURQUOISE,e.MEDIUMTURQUOISE,e.DARKTURQUOISE,e.LIGHTSEAGREEN,e.CADETBLUE,e.DARKCYAN,e.TEAL,e.DARKSLATEGRAY,e.DARKGREEN,e.GREEN,e.FORESTGREEN,e.SEAGREEN,e.MEDIUMSEAGREEN,e.MEDIUMAQUAMARINE,e.DARKSEAGREEN,e.AQUAMARINE,e.PALEGREEN,e.LIGHTGREEN,e.SPRINGGREEN,e.MEDIUMSPRINGGREEN,e.LAWNGREEN,e.CHARTREUSE,e.GREENYELLOW,e.LIME,e.LIMEGREEN,e.YELLOWGREEN,e.DARKOLIVEGREEN,e.OLIVEDRAB,e.OLIVE,e.DARKKHAKI,e.PALEGOLDENROD,e.CORNSILK,e.BEIGE,e.LIGHTYELLOW,e.LIGHTGOLDENRODYELLOW,e.LEMONCHIFFON,e.WHEAT,e.BURLYWOOD,e.TAN,e.KHAKI,e.YELLOW,e.GOLD,e.ORANGE,e.SANDYBROWN,e.DARKORANGE,e.GOLDENROD,e.PERU,e.DARKGOLDENROD,e.CHOCOLATE,e.SIENNA,e.SADDLEBROWN,e.MAROON,e.DARKRED,e.BROWN,e.FIREBRICK,e.INDIANRED,e.ROSYBROWN,e.DARKSALMON,e.LIGHTCORAL,e.SALMON,e.LIGHTSALMON,e.CORAL,e.TOMATO,e.ORANGERED,e.RED,e.CRIMSON,e.MEDIUMVIOLETRED,e.DEEPPINK,e.HOTPINK,e.PALEVIOLETRED,e.PINK,e.LIGHTPINK,e.THISTLE,e.MAGENTA,e.FUCHSIA,e.VIOLET,e.PLUM,e.ORCHID,e.MEDIUMORCHID,e.DARKORCHID,e.DARKVIOLET,e.DARKMAGENTA,e.PURPLE,e.INDIGO,e.DARKSLATEBLUE,e.BLUEVIOLET,e.MEDIUMPURPLE,e.SLATEBLUE,e.MEDIUMSLATEBLUE]}(Colors||(Colors={}));var Boss=function(e){function t(t){var n=e.call(this)||this;return n.last_throw_time=egret.getTimer(),n.type=t,n.speed=.1*t,n.init(),n}return __extends(t,e),t.prototype.init=function(){this.boss_mc=Common.buildTypeMc("boss_json","boss_png","boss"),this.boss_mc.anchorOffsetX=this.boss_mc.width/2,this.addChild(this.boss_mc),this.stage_width=egret.MainContext.instance.stage.stageWidth},t.prototype.run=function(){this.boss_mc.play(-1),this.boss_randomX=Math.random()*this.stage_width-50,this.boss_time=Math.abs(this.boss_randomX-this.x)/this.speed,egret.Tween.get(this).to({x:this.boss_randomX},this.boss_time),this.addEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this)},t.prototype.stop=function(){this.boss_mc.stop(),this.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this)},t.prototype.enterFrame=function(e){if(1===GameController.getInstance().gameState){var t=egret.getTimer();this.boss_randomX==this.x&&this.boss_walk_to_new_place(),this.last_throw_time+1e3<=t&&this.throwJewels()}},t.prototype.boss_walk_to_new_place=function(){this.last_randomX=this.boss_randomX,this.boss_randomX=Math.random()*this.stage_width-50>0?Math.random()*this.stage_width-50:10,this.boss_time=Math.abs(this.boss_randomX-this.last_randomX)/this.speed,this.boss_randomX<this.x?(this.boss_mc.scaleX=-1,egret.Tween.get(this).to({x:this.boss_randomX},this.boss_time)):(this.boss_mc.scaleX=1,egret.Tween.get(this).to({x:this.boss_randomX},this.boss_time))},t.prototype.throwJewels=function(){this.last_throw_time=egret.getTimer();var e=Math.floor(Math.random()*JewelsType.COUNT);SceneManager.getInstance().getGameScene().addJewels(e)},t}(egret.Sprite);__reflect(Boss.prototype,"Boss");var Jewels=function(e){function t(t){var n=e.call(this)||this;return n.speed=10*t,n.score=JewelsType.getScoreByJewelsType(t),n.type=t,n.init(),n}return __extends(t,e),t.prototype.init=function(){this.type==JewelsType.COIN?(this.coin_mc=Common.buildTypeMc("coin_json","coin_png","coin"),this.coin_mc.anchorOffsetX=this.coin_mc.width,this.coin_mc.anchorOffsetY=this.coin_mc.height,this.coin_mc.play(-1),this.addChild(this.coin_mc)):this.type==JewelsType.SHOE_SHAPED?(this.shoe_shaped_mc=Common.buildTypeMc("shoe-shaped_json","shoe-shaped_png","shoe-shaped"),this.shoe_shaped_mc.anchorOffsetX=this.shoe_shaped_mc.width/2,this.shoe_shaped_mc.anchorOffsetY=this.shoe_shaped_mc.height/2,this.addChild(this.shoe_shaped_mc)):this.type==JewelsType.CHEST?(this.chest_mc=Common.buildTypeMc("chest_json","chest_png","chest"),this.chest_mc.scaleX=.5,this.chest_mc.scaleY=.5,this.chest_mc.anchorOffsetX=this.chest_mc.width/2,this.chest_mc.anchorOffsetY=this.chest_mc.height/2,this.addChild(this.chest_mc)):(this.bomb_mc=Common.buildTypeMc("bomb_json","bomb_png","bomb"),this.bomb_mc.anchorOffsetX=this.bomb_mc.width/2,this.bomb_mc.anchorOffsetY=this.bomb_mc.height/2,this.addChild(this.bomb_mc)),egret.Tween.get(this,{loop:!0}).to({rotation:360},3e3)},t.prototype.getScore=function(){return this.score},t}(egret.Sprite);__reflect(Jewels.prototype,"Jewels");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){egret.lifecycle.addLifecycleListener(function(e){e.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadResource()];case 1:return t.sent(),this.createGameScene(),[4,platform.login()];case 2:return t.sent(),[4,platform.getUserInfo()];case 3:return e=t.sent(),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),e=new LoadingUI,this.stage.addChild(e),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),[4,RES.loadGroup("preload",0,e)];case 2:return n.sent(),this.stage.removeChild(e),[3,4];case 3:return t=n.sent(),console.error(t),[3,4];case 4:return[2]}})})},t.prototype.createGameScene=function(){this.addChild(SceneManager.getInstance()),GameController.getInstance().gameBefore()},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var Player=function(e){function t(t){var n=e.call(this)||this;return n.type=t,n._speed=10*t,n.init(),n}return __extends(t,e),t.prototype.init=function(){this.player_mc=Common.buildTypeMc("player_json","player_png","player"),this.player_mc.anchorOffsetX=this.player_mc.width/2,this.addChild(this.player_mc),this.touchEnabled=!0},Object.defineProperty(t.prototype,"speed",{get:function(){return this._speed},enumerable:!0,configurable:!0}),t.prototype.stop=function(){this.player_mc.stop()},t.prototype.run=function(){this.player_mc.play(-1)},t}(egret.Sprite);__reflect(Player.prototype,"Player");var GameController=function(){function e(){this._gameState=0}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.gameBefore=function(){SceneManager.getInstance().toStartScene(),this._gameState=0},e.prototype.gameStart=function(){this._gameState=1,SceneManager.getInstance().getGameScene().resetGame(),SceneManager.getInstance().toGameScene()},e.prototype.gameOver=function(){SceneManager.getInstance().toFailScene(),SceneManager.getInstance().getGameScene().gameOverStop(),this._gameState=2},e.prototype.gameEnd=function(){SceneManager.getInstance().toEndScene(),SceneManager.getInstance().getGameScene().gameOverStop(),this._gameState=3},e.prototype.gameRestart=function(){0!==Number(egret.localStorage.getItem("score"))&&egret.localStorage.setItem("score","0"),SceneManager.getInstance().getGameScene().resetGame(),SceneManager.getInstance().toGameScene(),this._gameState=1},e.prototype.gameNextLevel=function(){},e.prototype.addScore=function(e){var t=egret.localStorage.getItem("score");console.log(t);var n=Number(t)+Number(e);egret.localStorage.setItem("score",""+n),console.log(egret.localStorage.getItem("score"))},e.prototype.getPlayerScore=function(){return console.log("get score"),egret.localStorage.getItem("score")},Object.defineProperty(e.prototype,"gameState",{get:function(){return this._gameState},enumerable:!0,configurable:!0}),e._instance=null,e}();__reflect(GameController.prototype,"GameController");var BossType;!function(e){e.BOSS_1=1}(BossType||(BossType={}));var Common=function(){function e(){}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.buildTypeMc=function(e,t,n){var i=RES.getRes(e),s=RES.getRes(t),o=new egret.MovieClipDataFactory(i,s),r=new egret.MovieClip(o.generateMovieClipData(n));return r},e.prototype.align_center=function(e,t,n){e.width=t,"center"==n?e.x=egret.MainContext.instance.stage.stageWidth/2-e.width/2:"left"==n?e.x=egret.MainContext.instance.stage.stageWidth/4-e.width/2:e.x=3*egret.MainContext.instance.stage.stageWidth/4-e.width/2,e.textAlign=""+n},e.instance=null,e}();__reflect(Common.prototype,"Common");var Font;!function(e){e.MICRO_YAHEI="微软雅黑",e.KAITI="楷体"}(Font||(Font={}));var JewelsType;!function(e){function t(t){return e.JewelsScore[t]}e.JewelsScore=[],e.auto=0,e.BOMB=e.auto++,e.JewelsScore[e.BOMB]=-1,e.COIN=e.auto++,e.JewelsScore[e.COIN]=10,e.SHOE_SHAPED=e.auto++,e.JewelsScore[e.SHOE_SHAPED]=20,e.CHEST=e.auto++,e.JewelsScore[e.CHEST]=30,e.COUNT=e.auto,e.getScoreByJewelsType=t}(JewelsType||(JewelsType={}));var Language;!function(e){e.START_GAME_TEXT="开始游戏",e.GAME_OVER_TEXT="闯关失败",e.RETRY_GAME_TEXT="重试",e.REVIVE_GAME_TEXT="复活",e.COUNT_DOWN_TEXT="倒计时",e.RECORD_MAX_LEVEL_TEXT="历史最高记录为第",e.CURR_LEVEL_TEXT="当前关卡为",e.LEVEL_TEXT="关卡"}(Language||(Language={}));var PlayerType;!function(e){e.Player_1=1}(PlayerType||(PlayerType={}));var FailScene=function(e){function t(){var t=e.call(this)||this;return t.init(),t}return __extends(t,e),t.prototype.init=function(){this.failed_bg=new egret.Bitmap;var e=RES.getRes("failed_bg_png");this.failed_bg.texture=e,this.failed_bg.width=egret.MainContext.instance.stage.stageWidth,this.failed_bg.height=egret.MainContext.instance.stage.stageHeight,this.addChild(this.failed_bg),this.game_failed=new egret.TextField,this.game_failed.y=250,Common.align_center(this.game_failed,500,"center"),this.game_failed.fontFamily=Font.MICRO_YAHEI,this.game_failed.size=90,this.game_failed.textColor=15608876,this.game_failed.strokeColor=15636992,this.game_failed.bold=!0,this.game_failed.text="你接到炸弹啦！",this.addChild(this.game_failed),this.retry=new egret.TextField,this.retry.y=700,Common.align_center(this.retry,100,"left"),this.retry.fontFamily=Font.MICRO_YAHEI,this.retry.size=50,this.retry.textColor=15636992,this.retry.strokeColor=15636992,this.retry.bold=!0,this.retry.touchEnabled=!0,this.retry.text="重试",this.addChild(this.retry),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},t.prototype.onTouchTap=function(){GameController.getInstance().gameRestart()},t}(egret.Sprite);__reflect(FailScene.prototype,"FailScene");var GameEndScene=function(e){function t(){var t=e.call(this)||this;return t.init(),t}return __extends(t,e),t.prototype.init=function(){this.failed_bg=new egret.Bitmap;var e=RES.getRes("failed_bg_png");this.failed_bg.texture=e,this.failed_bg.width=egret.MainContext.instance.stage.stageWidth,this.failed_bg.height=egret.MainContext.instance.stage.stageHeight,this.addChild(this.failed_bg),this.game_end=new egret.TextField,this.game_end.y=250,Common.align_center(this.game_end,500,"center"),this.game_end.fontFamily=Font.MICRO_YAHEI,this.game_end.size=90,this.game_end.textColor=15608876,this.game_end.strokeColor=15636992,this.game_end.bold=!0,this.game_end.text="游戏结束",this.addChild(this.game_end),this.game_score=new egret.TextField,this.game_score.y=400,Common.align_center(this.game_score,500,"center"),this.game_score.fontFamily=Font.MICRO_YAHEI,this.game_score.size=50,this.game_score.textColor=Colors.LIGHTYELLOW,this.game_score.bold=!0,this.addChild(this.game_score),this.next_level=new egret.TextField,this.next_level.y=700,Common.align_center(this.next_level,500,"center"),this.next_level.fontFamily=Font.MICRO_YAHEI,this.next_level.size=50,this.next_level.textColor=Colors.BLACK,this.next_level.bold=!0,this.next_level.touchEnabled=!0,this.next_level.text="下一关",this.addChild(this.next_level),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},t.prototype.onTouchTap=function(){GameController.getInstance().gameNextLevel()},t.prototype.setEndScore=function(e){this.game_score.text="您的得分为"+e},t}(egret.Sprite);__reflect(GameEndScene.prototype,"GameEndScene");var GameScene=function(e){function t(){var t=e.call(this)||this;return t.init(),t}return __extends(t,e),t.prototype.init=function(){this.touchEnabled=!0,this.touchChildren=!0,this.game_bg=new egret.Bitmap,this.game_bg.texture=RES.getRes("game_bg_png"),this.game_bg.width=egret.MainContext.instance.stage.stageWidth,this.game_bg.height=egret.MainContext.instance.stage.stageHeight,this.addChild(this.game_bg),this.boss_mc=new Boss(BossType.BOSS_1),this.boss_mc.y=100,this.addChild(this.boss_mc),this.boss_mc.run(),this.player_mc=new Player(PlayerType.Player_1),this.player_mc.y=800,this.player_mc.run(),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchStop,this),this.addChild(this.player_mc),this.player_score=new egret.TextField,this.player_score.textColor=Colors.DARKRED,Common.align_center(this.player_score,150,"right"),this.player_score.y=20,this.player_score.size=40,this.player_score.text="得分0",this.addChild(this.player_score),this.countDown=new egret.TextField,this.countDown.x=egret.MainContext.instance.stage.stageWidth-150,this.countDown.textAlign="center",this.countDown.fontFamily=Font.MICRO_YAHEI,this.countDown.size=30,this.countDown.textColor=15608876,this.countDown.strokeColor=15636992,this.addChild(this.countDown),egret.localStorage.setItem("score","0")},t.prototype.countTime=function(){if(1==GameController.getInstance().gameState){var e=egret.getTimer(),t=e-this.countTimeStart;this.count=60-Math.floor(t/1e3),this.count<=0&&(this.count=0,this.last_score=GameController.getInstance().getPlayerScore(),console.log("时间到"),SceneManager.getInstance().getEndScene().setEndScore(this.last_score),GameController.getInstance().gameEnd()),console.log("倒计时: ",this.count),this.countDown.text=Language.COUNT_DOWN_TEXT+this.count+"秒"}this.player_mc.x-this.targetX>0?this.player_mc.x-this.targetX<this.player_mc.speed?this.player_mc.x=this.targetX:this.player_mc.x>this.player_mc.width&&(this.player_mc.x-=this.player_mc.speed):this.targetX-this.player_mc.x<this.player_mc.speed?this.player_mc.x=this.targetX:this.player_mc.x<egret.MainContext.instance.stage.stageWidth-this.player_mc.width&&(this.player_mc.x+=this.player_mc.speed)},t.prototype.addJewels=function(e){var t=this;if(void 0===e&&(e=JewelsType.BOMB),1==GameController.getInstance().gameState){var n=new Jewels(e);n.x=this.boss_mc.x,n.y=100,this.addChild(n),egret.Tween.get(n).to({y:800},2e3).call(function(){if(Math.abs(t.player_mc.x-n.x)<50)if(console.log(e),0==e)console.log("die"),GameController.getInstance().gameOver();else{console.log("得分"),GameController.getInstance().addScore(n.getScore()),t.player_score.text="得分"+GameController.getInstance().getPlayerScore();var i=new egret.TextField;i.text="+"+n.getScore(),i.y=t.player_mc.y-i.height,i.x=t.player_mc.x-i.width,i.textColor=Colors.DARKORANGE,t.addChild(i),egret.Tween.get(i).to({y:i.y-20,alpha:0},500).call(function(){t.contains(i)&&(t.removeChild(i),i=null)})}t.contains(n)&&t.removeChild(n)})}},t.prototype.resetGame=function(){this.countTimeStart=egret.getTimer(),this.player_score.text="得分"+GameController.getInstance().getPlayerScore(),this.boss_mc.x=0,this.player_mc.x=egret.MainContext.instance.stage.stageWidth/2,this.boss_mc.run(),this.player_mc.run(),console.log("this.resetgame"),this.addEventListener(egret.TouchEvent.ENTER_FRAME,this.countTime,this)},t.prototype.gameOverStop=function(){console.log("this.gameover"),this.boss_mc.stop(),this.player_mc.stop(),this.removeEventListener(egret.TouchEvent.ENTER_FRAME,this.countTime,this)},t.prototype.onTouchMove=function(e){e.stageX>this.player_mc.x?(this.player_mc.scaleX=1,this.targetX=640):(this.player_mc.scaleX=-1,this.targetX=0)},t.prototype.onTouchStop=function(e){egret.Tween.pauseTweens(e.target)},t}(egret.Sprite);__reflect(GameScene.prototype,"GameScene");var SceneManager=function(e){function t(){var t=e.call(this)||this;return t.init(),t}return __extends(t,e),t.prototype.init=function(){this.startScene=new StartScene,this._gameScene=new GameScene,this.failScene=new FailScene,this.endScene=new GameEndScene},t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.toGameScene=function(){this.contains(this.startScene)&&this.removeChild(this.startScene),this.addChild(this._gameScene),this.contains(this.failScene)&&this.removeChild(this.failScene),this.contains(this.endScene)&&this.removeChild(this.endScene)},t.prototype.toStartScene=function(){this.addChild(this.startScene),this.contains(this._gameScene)&&this.removeChild(this._gameScene),this.contains(this.failScene)&&this.removeChild(this.failScene),this.contains(this.endScene)&&this.removeChild(this.endScene)},t.prototype.toFailScene=function(){this.addChild(this.failScene),this.contains(this.startScene)&&this.removeChild(this.startScene),this.contains(this._gameScene)&&this.removeChild(this._gameScene),this.contains(this.endScene)&&this.removeChild(this.endScene)},t.prototype.toEndScene=function(){this.addChild(this.endScene),this.contains(this.startScene)&&this.removeChild(this.startScene),this.contains(this._gameScene)&&(console.log("remove failscene"),this.removeChild(this._gameScene)),this.contains(this.failScene)&&this.removeChild(this.failScene)},t.prototype.getGameScene=function(){return this._gameScene},t.prototype.getFailScene=function(){return this.failScene},t.prototype.getEndScene=function(){return this.endScene},t.instance=null,t}(egret.DisplayObjectContainer);__reflect(SceneManager.prototype,"SceneManager");var StartScene=function(e){function t(){var t=e.call(this)||this;return t.init(),t}return __extends(t,e),t.prototype.init=function(){this.start_bg=new egret.Bitmap,this.start_bg.texture=RES.getRes("bg_png"),this.start_bg.width=egret.MainContext.instance.stage.stageWidth,this.start_bg.height=egret.MainContext.instance.stage.stageHeight,this.addChild(this.start_bg),this.startGameText=new egret.TextField,Common.align_center(this.startGameText,500,"center"),this.startGameText.y=egret.MainContext.instance.stage.stageHeight-200,this.startGameText.width=500,this.startGameText.size=70,this.startGameText.fontFamily=Font.KAITI,this.startGameText.textColor=Colors.GOLD,this.startGameText.bold=!0,this.startGameText.text=Language.START_GAME_TEXT,this.addChild(this.startGameText),this.startGameText.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startGame,this)},t.prototype.startGame=function(e){GameController.getInstance().gameStart()},t}(egret.Sprite);__reflect(StartScene.prototype,"StartScene");